(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){var e,n,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function l(t,o,a,i){var l=o&&o.prototype instanceof u?o:u,s=Object.create(l.prototype);return r(s,"_invoke",function(t,r,o){var a,i,l,u=0,s=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,r){return a=t,i=0,l=e,f.n=r,c}};function d(t,r){for(i=t,l=r,n=0;!p&&u&&!o&&n<s.length;n++){var o,a=s[n],d=f.p,b=a[2];t>3?(o=b===r)&&(l=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=t<2&&d<a[1])?(i=0,f.v=r,f.n=a[1]):d<b&&(o=t<3||a[0]>r||r>b)&&(a[4]=t,a[5]=r,f.n=b,i=0))}if(o||t>1)return c;throw p=!0,r}return function(o,s,b){if(u>1)throw TypeError("Generator is already running");for(p&&1===s&&d(s,b),i=s,l=b;(n=i<2?e:l)||!p;){a||(i?i<3?(i>1&&(f.n=-1),d(i,l)):f.n=l:f.v=l);try{if(u=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((n=(p=f.n<0)?l:t.call(r,f))!==c)break}catch(t){a=e,i=1,l=t}finally{u=1}}return{value:n,done:p}}}(t,a,i),!0),s}var c={};function u(){}function s(){}function p(){}n=Object.getPrototypeOf;var f=[][a]?n(n([][a]())):(r(n={},a,function(){return this}),n),d=p.prototype=u.prototype=Object.create(f);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,r(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=p,r(d,"constructor",p),r(p,"constructor",s),s.displayName="GeneratorFunction",r(p,i,"GeneratorFunction"),r(d),r(d,i,"Generator"),r(d,a,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(t=function(){return{w:l,m:b}})()}function r(e,t,n,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}r=function(e,t,n,o){function i(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},r(e,t,n,o)}function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var _n=0,n=function(){};return{s:n,n:function(){return _n>=e.length?{done:!0}:{done:!1,value:e[_n++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw o}}}}function o(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}var f=wp.blocks.registerBlockType,d=(wp.blockEditor||wp.editor).InspectorControls,b=wp.components,m=b.PanelBody,y=b.TextControl,v=b.ToggleControl,g=b.RangeControl,h=b.SelectControl,w=b.TextareaControl,x=b.ColorPicker,E=b.Button,k=wp.element,R=k.useEffect,O=k.useState,j=wp.apiFetch,S=wp.blockEditor.RichText,C=wp.blockEditor,P=C.MediaUpload,_=C.MediaUploadCheck;"undefined"!=typeof wp&&wp.blocks&&wp.blockEditor&&wp.components&&wp.element&&"undefined"!=typeof ewp_blocks&&Object.keys(ewp_blocks).forEach(function(e){var r=ewp_blocks[e],i="".concat(r.namespace,"/").concat(r.name);console.log("Registering block:",i),console.log("Block attributes:",r.attributes),f(i,{title:r.title,icon:r.icon,category:r.category,attributes:u(u({},r.attributes),{},{isValid:{type:"boolean",default:!0}}),edit:function(e){var i=e.attributes,l=e.setAttributes,c=Object.keys(r.attributes).reduce(function(e,t){var n=r.attributes[t];return e[t]=i[t]||n.default||"",e},{}),f=a(O(""),2),b=f[0],k=f[1],C=a(O(c),2),T=C[0],I=C[1],A=a(O({}),2),B=A[0],D=A[1],F=a(O({}),2),G=F[0],M=F[1],H=function(e,t){r.attributes[e],I(u(u({},T),{},s({},e,t))),l(s({},e,t)),N(e,t)},N=function(e,t){var n;null!==(n=r.attributes[e])&&void 0!==n&&n.required&&!t?(D(function(t){return u(u({},t),{},s({},e,"".concat(r.attributes[e].label||e," is required.")))}),l({isValid:!1})):(D(function(t){return t[e],function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,[e].map(p))}),l({isValid:!0}))},z=function(){var e,r=(e=t().m(function e(r){var o,a,i,l,c,s,p,f;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:o={},a=n(r),e.p=1,a.s();case 2:if((i=a.n()).done){e.n=7;break}if(l=i.value,G[l]){e.n=6;break}return e.p=3,e.n=4,j({path:"/wp/v2/media/".concat(l)});case 4:s=e.v,o[l]={url:(null===(c=s.media_details)||void 0===c||null===(c=c.sizes)||void 0===c||null===(c=c.thumbnail)||void 0===c?void 0:c.source_url)||s.source_url,alt:s.alt_text||"Image ".concat(l)},e.n=6;break;case 5:e.p=5,p=e.v,console.warn("Failed to fetch image data for ID ".concat(l,":"),p),o[l]={url:"",alt:"Image ".concat(l)};case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,f=e.v,a.e(f);case 9:return e.p=9,a.f(),e.f(9);case 10:Object.keys(o).length>0&&M(function(e){return u(u({},e),o)});case 11:return e.a(2)}},e,null,[[3,5],[1,8,9,10]])}),function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function l(e){o(i,n,a,l,c,"next",e)}function c(e){o(i,n,a,l,c,"throw",e)}l(void 0)})});return function(_x){return r.apply(this,arguments)}}();return R(function(){var e=new URLSearchParams(T).toString();j({path:"".concat(r.namespace,"/").concat(r.name,"/preview?").concat(e)}).then(function(e){k(e);var t=new CustomEvent("ewp_dynamic_block_on_change",{detail:{response:e,block:r}});document.dispatchEvent(t)})},[JSON.stringify(T)]),React.createElement(React.Fragment,null,React.createElement(d,null,React.createElement(m,{title:r.title+" Settings",initialOpen:!0},Object.entries(r.attributes).map(function(t){var r=a(t,2),n=r[0],o=r[1],i=o.required?"".concat(o.label," *"):o.label,l=o.explanation?wp.element.createElement("small",{style:{display:"block",marginTop:"0px",marginBottom:"10px",letterSpacing:"normal",color:"#555",lineHeight:"1.5"}},o.explanation):null;switch(o.render_type){case"color":return React.createElement("div",{key:n},React.createElement("label",{style:{display:"block",marginBottom:"4px"}},i),l," ",React.createElement(x,{color:e.attributes[n]||"",onChangeComplete:function(e){return H(n,e.hex)},disableAlpha:!0}));case"textarea":return React.createElement("div",{key:n},React.createElement("label",{style:{display:"block",marginBottom:"4px"}},i),l," ",o.wp_editor?React.createElement(S,{tagName:"p",value:e.attributes[n]||"",onChange:function(e){return H(n,e)},placeholder:o.placeholder||"",style:{border:"1px solid #ccd0d4",padding:"10px",borderRadius:"4px",backgroundColor:"#fff",minHeight:"150px"}}):React.createElement(w,{value:e.attributes[n]||"",onChange:function(e){return H(n,e)},style:{border:"1px solid #ccd0d4",padding:"10px",borderRadius:"4px",backgroundColor:"#fff",minHeight:"150px"}}));case"boolean":return React.createElement("div",{key:n},React.createElement("label",{style:{display:"block",marginBottom:"4px"}},i),l," ",React.createElement(v,{checked:!!e.attributes[n],onChange:function(e){return H(n,e)}}));case"string":return React.createElement("div",{key:n},React.createElement("label",{style:{display:"block",marginBottom:"4px"}},i),l," ",React.createElement(y,{value:e.attributes[n]||"",onChange:function(e){return H(n,e)}}));case"number":return React.createElement("div",{key:n},React.createElement("label",{style:{display:"block",marginBottom:"4px"}},i),l," ",React.createElement(g,{value:e.attributes[n]||0,onChange:function(e){return H(n,e)},min:o.min||0,max:o.max||100}));case"select":var c=Array.isArray(o.options)?o.options.map(function(e){return{value:e.option,label:e.label}}):[];return React.createElement("div",{key:n},React.createElement("label",{style:{display:"block",marginBottom:"4px"}},i),l," ",React.createElement(h,{value:e.attributes[n]||"",options:c,onChange:function(e){return H(n,e)}}));case"gallery":var u=e.attributes[n]||[],s=Array.isArray(u)?u:[];return R(function(){s.length>0&&z(s)},[s.join(",")]),React.createElement("div",{key:n},React.createElement("label",{style:{display:"block",marginBottom:"4px"}},i),l,React.createElement(_,null,React.createElement(P,{onSelect:function(e){var t=e.map(function(e){return e.id});H(n,t)},allowedTypes:["image"],multiple:!0,gallery:!0,value:s,render:function(e){var t=e.open;return React.createElement("div",null,s.length>0&&React.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(80px, 1fr))",gap:"8px",marginBottom:"15px"}},s.map(function(e,t){var r=G[e];return React.createElement("div",{key:e,style:{position:"relative",width:"80px",height:"80px"}},null!=r&&r.url?React.createElement("img",{src:r.url,alt:r.alt,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"4px",border:"1px solid #ddd"}}):React.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"#f0f0f0",borderRadius:"4px",border:"1px solid #ddd",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",color:"#666"}},"Loading..."),React.createElement("button",{onClick:function(t){t.preventDefault(),t.stopPropagation();var r=s.filter(function(t){return t!==e});H(n,r)},type:"button",style:{position:"absolute",top:"2px",right:"2px",width:"18px",height:"18px",padding:"0",margin:"0",border:"1px solid white",borderRadius:"50%",backgroundColor:"#dc3545",color:"white",fontSize:"12px",fontWeight:"bold",lineHeight:"16px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 1px 3px rgba(0,0,0,0.3)",zIndex:"10"},onMouseEnter:function(e){e.target.style.backgroundColor="#c82333"},onMouseLeave:function(e){e.target.style.backgroundColor="#dc3545"}},"Ã—"))})),React.createElement("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"}},React.createElement(E,{onClick:t,variant:"secondary"},s.length>0?"Edit Gallery":"Select Images"),s.length>0&&React.createElement(E,{onClick:function(){return H(n,[])},variant:"secondary",isDestructive:!0},"Clear All Images")))}})));default:return null}}))),React.createElement("div",{className:e.className},Object.keys(B).map(function(e){return React.createElement("p",{key:e,style:{color:"red"}},B[e])}),React.createElement("div",{dangerouslySetInnerHTML:{__html:b}})))},save:function(e){return e.attributes.isValid,null}})})})();
//# sourceMappingURL=index.js.map